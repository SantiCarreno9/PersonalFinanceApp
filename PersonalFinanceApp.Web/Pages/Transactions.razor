@page "/transactions"
@using Microsoft.AspNetCore.Components.QuickGrid
@using Syncfusion.Blazor
@using Syncfusion.Blazor.Calendars
@using Syncfusion.Blazor.Buttons
@using Syncfusion.Blazor.Popups
@using Syncfusion.Blazor.Navigations

@using PersonalFinanceApp.Web.Components

<div style="flex-direction:column">
    <h3>Transactions</h3>
    <button class="btn btn-primary" @onclick="()=>{shouldShowDialog=true;}"> Add Transaction </button>
</div>
<br />
@if (transactionTypes == null)
{
    <p>Loading...</p>
}
else
{
    <ul class="nav nav-tabs">
        @foreach (var item in transactionTypes)
        {
            <li class="nav-item">
                <a class="nav-link @(currentTransactionType==item.Id?"active":"")" aria-current="page" href="#"
                @onclick:preventDefault @onclick="()=>OnTabSelected(item.Id)">@item.Name</a>
            </li>
        }
        @*<li class="nav-item">
    <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
    </li> *@
    </ul>
}
@if (visibleTransactions == null)
{
    <p>Loading...</p>
}
else
{
    <div style="width:100%">
        <QuickGrid style="width:100%" Virtualize Items="@visibleTransactions">
            <PropertyColumn Property="@(p => p.Location)" Sortable="true" />
            <PropertyColumn Property="@(p => p.Date)" Format="MMMM dd, yyyy" Sortable="true" />
            <PropertyColumn Property="@(p => categories[p.CategoryId])" Sortable="true" Title="Category"/>
            <PropertyColumn Property="@(p => p.TotalAmount)" Sortable="true" />
            <TemplateColumn Context="transaction">
                <SfIcon Name="IconName.Eye"></SfIcon>
                <SfIcon Name="IconName.Trash"></SfIcon>
            </TemplateColumn>
        </QuickGrid>
    </div>
}
<SfDialog Width="500px" ShowCloseIcon="true" IsModal @bind-Visible=shouldShowDialog>
    <DialogTemplates>
        <Header>
            Add Expense
        </Header>
        <Content>
            <TransactionEditor OnSuccessfullySubmitted="OnTransactionAdded"></TransactionEditor>
        </Content>
    </DialogTemplates>
    <DialogEvents OnClose="HideDialog"></DialogEvents>
</SfDialog>